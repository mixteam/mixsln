define("mix/core/ui/template/0.2.0/template",["mix/core/base/reset/1.0.0/reset","mix/core/base/class/1.0.0/class","mix/libs/handlebars/1.0.5/handlebars"],function(e,t,n){e("mix/core/base/reset/1.0.0/reset");var r=e("mix/core/base/class/1.0.0/class"),i=e("mix/libs/handlebars/1.0.5/handlebars"),s=undefined,o=window,u=o.document,a=r.create({initialize:function(e,t,n){var r=this;r._id=a.id(),r._name=e||"template"+r._id,r._type=t||"template",r._root=n||"root",r._helpers={},r._partials={},r._chunks={},r._html="",r._nodeList=[]},_init:function(){var e=this;e._helpers=Object.extend(e._helpers,i.helpers),e._partials=Object.extend(e._partials,i.partials),a.helpers(e),a.partials(e),a.chunks(e)},addHelper:function(e,t){var n=this;if(arguments.length===1){Object.each(arguments[0],function(e,t){n.addHelper(t,e)});return}n._helpers[e]=t},addPartial:function(e,t){var n=this;if(arguments.length===1){Object.each(arguments[0],function(e,t){n.addHelper(t,e)});return}n._partials[e]=t},addChunk:function(e,t){var n=this;n._chunks[e]=t},compile:function(e){var t=this;e&&(t._init(),t._template=a.compile(t,e))},_wrap:function(e){var t=this,n=t._name,r=t._id,i=n+"/"+r,s=t._type,o=u.createElement("template"),a,f;o.innerHTML=e,a=o.firstElementChild,f=o.lastElementChild,a||(a=u.createElement("template"),o.firstChild?o.insertBefore(a,o.firstChild):o.appendChild(a)),f||(f=u.createElement("template"),o.appendChild(f)),a.setAttribute(s+"-begin",i),f.setAttribute(s+"-end",i),t._html=o.innerHTML,t._nodeList=[],Object.each(o.childNodes,function(e){t._nodeList.push(e)})},all:function(e){var t=this,n=t._root,r=t._helpers,s=t._name,e=e||t._data,o;return t._data=e,n instanceof a&&(r=Object.extend({},n._helpers,r)),o=t._template(e,{helpers:r}),t._template2=i.compile(o),o=t._template2({},{partials:t._partials}),t._wrap(o),t._html},_replace:function(){var e=this,t=e._name,n=e._id,r=e._type,i=e._nodeList,s=u.createDocumentFragment(),o,a,f,l;o=u.querySelector("*["+r+'-begin="'+t+"/"+n+'"]'),a=u.querySelector("*["+r+'-end="'+t+"/"+n+'"]'),l=o.parentNode||a.parentNode;while(o!==a)f=o.nextElementSibling,l.removeChild(o),o=f;Object.each(i,function(e){s.appendChild(e)}),l.insertBefore(s,a),l.removeChild(a)},update:function(e,t){var n=this,r=u.createElement("template"),i,s,o,a,f,l;return i=typeof e=="string"?e.split(/[.\/]/g):e,i.length?(o=i.shift(),s=n._chunks[o],s?(n._partials[o]=s.update(i,t),n._html=n._template2({},{partials:n._partials})):(a=n._data,i.unshift(o),l=i.pop(),Object.each(i,function(e){a=a[e]}),a[l]=t,n.all(a),n._replace(f))):(a=n._data,Object.keys(a).length!==Object.keys(t).length&&(t=Object.extend({},a,t)),n.all(t),n._replace(f)),n._html},destroy:function(){var e=this,t=e._chunks;Object.each(t,function(e){e.destroy()}),delete e._template,delete e._template2,delete e._data,delete e._chunks}}),f=/(\{\{#chunk\s+[^}\s]+\s*[^}]*\}\})|(\{\{\/chunk\}\})/g,l=/\{\{#chunk\s+([^}\s]+)\s*\}\}/,c=/\{\{\/chunk\}\}/,h=1;a.id=function(){return h++},a.helpers=function(e){e.addHelper("chunk",function(t){var n;return n=e._chunks[t],e._partials[t]=n.all(this),new i.SafeString("{{> "+t+"}}")})},a.partials=function(e){},a.chunks=function(e){},a.compile=function(e,t){var n,r=[],s=[];return n=t.match(f),n&&n.forEach(function(n){var o,u,f,h,p,d,v,m,g,y,b,w;u=n.match(c),u?(o=r.pop(),v=s.pop(),m=s.length?s[s.length-1]:e,f=o[0],h=u[0],b=o[1],p=t.indexOf(f),d=t.indexOf(h),g=t.substring(0,p),w=t.substring(p+f.length,d),y=t.substring(d+h.length),t=g+"{{#with "+b+'}}{{chunk "'+b+'"}}{{/with}}'+y,v._name=b,v._root=m,v._type="chunk",v._template=i.compile(w),m.addChunk(b,v)):(o=n.match(l),r.push(o),m=new a,m._init(),s.push(m))}),i.compile(t)},n.exports=a});