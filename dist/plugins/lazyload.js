(function(a,b){function i(){return h?h.fn.getScrollTop():c.body.scrollTop}function k(){return h?h.offsetHeight:c.body.clientHeight}var h,c=a.document,d=a.navigator,e=d.appVersion,g=(/android/gi.test(e),/iphone|ipad/gi.test(e));b.plugin.lazyload={_options:null,_startScrollTime:0,_endScrollTime:0,_scrollFlickTime:200,_getParent:function(a){return a.offsetParent||a.parentNode},_getOffset:function(a){var g,d=b.component.getActiveContent(),e=getComputedStyle(a),f=parseFloat(a.getAttribute("height")||a.offsetHeight||e.height),i=parseFloat(a.offsetTop),j=0;if(!h)for(g=this._getParent(d);g&&g!=c.body;)j+=parseFloat(g.offsetTop),g=this._getParent(g);for(g=this._getParent(a);g&&g!=d;)i+=parseFloat(g.offsetTop||0),g=this._getParent(g);return{top:i+j,bottom:i+f+j}},_checkStart:function(){this._startScrollTime=Date.now()},_checkEnd:function(){var a=this;if(this._endScrollTime=Date.now(),this._endScrollTime-this._startScrollTime<this._scrollFlickTime)if(g)window.addEventListener("scroll",this.check);else var b=c.body.scrollTop,d=setInterval(function(){b===c.body.scrollTop?(clearInterval(d),a.check()):b=c.body.scrollTop},50);else this.check()},check:function(){for(var a=this._options,c=a.page.dataAttr||"data-src",d=b.component.getActiveContent(),e=d.querySelectorAll("img["+c+"]"),f=i(),g=i()+k(),h=0;e.length>h;h++){var m,j=e[h],l=this._getOffset(j);(l.top>f&&g>l.top||l.bottom>f&&g>l.bottom)&&(m=j.getAttribute(c),m&&(j.setAttribute("src",m),j.removeAttribute(c)))}},on:function(a,d){this._options=d,h=b.component.get("scroll"),this._checkStart=this._checkStart.bind(this),this._checkEnd=this._checkEnd.bind(this),this.check=this.check.bind(this),h?b.component.on("scrollEnd",this.check):(c.addEventListener("touchstart",this._checkStart,!1),c.addEventListener("touchend",this._checkEnd,!1))},off:function(){h?b.component.off("scrollEnd",this.check):(c.removeEventListener("touchstart",this._checkStart,!1),c.removeEventListener("touchend",this._checkEnd,!1))}}})(window,window.app);